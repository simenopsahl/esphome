# for horizontal 480x800 displays

font: !include
  file: fonts/fonts.yaml
  vars:
    text_sm: 26
    text_md: 30
    text_lg: 34
    text_xl: 48
    text_xxl: 64
    text_hg: 120
    text_fl: 200
    icons_sm: 26
    icons_md: 32
    icons_lg: 40
    icons_xl: 48
    icons_xxl: 56

.sizing:
  - &nav_widget_vars
    height: 44
    padding: 14

  - &page_styles
    <<: !include styles/page_styles.yaml
    page_pad_top: 44
    page_pad_bottom: 44

  - &clock_page_styles
    meter_height: 360
    meter_width: 360

  - &container_styles
    <<: !include styles/container_styles.yaml
    container_pad_top: 2
    container_pad_bottom: 2
    container_pad_left: 10
    container_pad_right: 10
    container_scrollable: false # prevents scrollbars on pages where space is used up to the last pixel

  - &button_layout
    <<: !include styles/button_layout.yaml
    pad_column: 10
    pad_row: 10

  - &button_widget_vars
    width: 49%
    height: 100

  - &wide_button_widget_vars
    width: 100%
    height: 100

# Styles for Weather forcast
.forcast_styles:
    - &forcast_obj_base
      height: SIZE_CONTENT
      width: SIZE_CONTENT
      bg_color: c_black
      radius: 3
      pad_top: 2
      pad_bottom : 2
      layout:
        type: flex
        flex_flow: COLUMN
        flex_align_cross: center
        flex_align_track: center
        pad_column: 0
        pad_row: 2

    - &forcast_label_base
      text_font: font_md
      height: SIZE_CONTENT

    - &forcast_label_base_sm
      height: SIZE_CONTENT
      text_font: font_sm
      text_color: c_text_s

    - &forcast_image_base
      height: SIZE_CONTENT

script:
  - id: go_home
    then:
      - lvgl.page.show: ${home_page}

lvgl:
  default_font: font_md
  theme: !include themes/main.yaml
  disp_bg_color: 0x000000
  bg_color: 0x000000
  top_layer:
    widgets:
      - <<: !include { file: widgets/header/widget.yaml, vars: { <<: *nav_widget_vars } }
      - <<: !include { file: widgets/footer/widget.yaml, vars: { <<: *nav_widget_vars } }
      - <<: !include { file: widgets/boot_screen/widget.yaml }
  pages:
    - id: page_splash
      skip: true
      on_load:
        - script.execute: go_home

    # analog clock
    - <<: !include { file: pages/clock/page.yaml, vars: { <<: [*page_styles, *container_styles, *clock_page_styles] } }

    # device status
    - <<: !include { file: pages/status/page.yaml, vars: { <<: [*page_styles, *container_styles] } }

    # room temperature
    - <<: !include { file: pages/temperature/page.yaml, vars: { <<: [*page_styles, *container_styles] } }

    # weather forecast
    - id: page_weather
      <<: *page_styles
      on_load:
        - lvgl.label.update:
            id: page_title
            text: Vær
      <<: !include
        file: functions/swipe_navigation.yaml
      widgets:
        - obj:
            pad_all: 8
            height: 100%
            width: 100%
            align: CENTER
            layout:
              type: GRID
              grid_rows: [ fr(4), fr(3) ]
              grid_columns: [ fr(7), fr(6) ]
            widgets:
              - obj:
                  height: SIZE_CONTENT
                  width: SIZE_CONTENT
                  grid_cell_row_pos: 0
                  grid_cell_column_pos: 0
                  grid_cell_y_align: CENTER
                  widgets:
                    - image:
                        src: unknown_200
                        id: weather_condition_icon
              - obj:
                  grid_cell_row_pos: 0
                  grid_cell_column_pos: 1
                  grid_cell_y_align: CENTER
                  bg_opa: TRANSP
                  layout:
                    type: FLEX
                    flex_flow: COLUMN
                    flex_align_main: START
                    flex_align_cross: START
                  widgets:
                    - label:
                        text: "--°"
                        id: weather_temperature_today
                        text_font: font_xl
                        text_align: LEFT
                    - label:
                        text: "Været nå"
                        id: weather_condition_today
                        long_mode: wrap
                        scrollable: true
                        text_font: font_md
                        text_align: LEFT

              - obj:
                  width: 100%
                  height: SIZE_CONTENT
                  grid_cell_row_pos: 1
                  grid_cell_column_pos: 0
                  grid_cell_column_span: 2
                  grid_cell_y_align: CENTER
                  grid_cell_x_align: STRETCH
                  layout:
                    type: GRID
                    grid_rows: [ content ]
                    grid_columns: [ 80, 80, 80, 80 ]
                    pad_column: 6
                    pad_row: 0
                  widgets:
                      - obj:
                          <<: *forcast_obj_base
                          grid_cell_row_pos: 0
                          grid_cell_column_pos: 0
                          widgets:
                              - label:
                                  id: forecast_timestamp_0
                                  <<: *forcast_label_base_sm
                                  text: ???
                              - image:
                                  id: forecast_condition_icon_0
                                  <<: *forcast_image_base
                                  src: unknown_80
                              - label:
                                  id: forecast_temperature_0
                                  <<: *forcast_label_base
                                  text: "--°"
                      - obj:
                          <<: *forcast_obj_base
                          grid_cell_row_pos: 0
                          grid_cell_column_pos: 1
                          widgets:
                              - label:
                                  id: forecast_timestamp_1
                                  <<: *forcast_label_base_sm
                                  text: ???
                              - image:
                                  id: forecast_condition_icon_1
                                  <<: *forcast_image_base
                                  src: unknown_80
                              - label:
                                  id: forecast_temperature_1
                                  <<: *forcast_label_base
                                  text: "--°"
                      - obj:
                          <<: *forcast_obj_base
                          grid_cell_row_pos: 0
                          grid_cell_column_pos: 2
                          widgets:
                              - label:
                                  id: forecast_timestamp_2
                                  <<: *forcast_label_base_sm
                                  text: ???
                              - image:
                                  id: forecast_condition_icon_2
                                  <<: *forcast_image_base
                                  src: unknown_80
                              - label:
                                  id: forecast_temperature_2
                                  <<: *forcast_label_base
                                  text: "--°"
                      - obj:
                          <<: *forcast_obj_base
                          grid_cell_row_pos: 0
                          grid_cell_column_pos: 3
                          widgets:
                              - label:
                                  id: forecast_timestamp_3
                                  <<: *forcast_label_base_sm
                                  text: ???
                              - image:
                                  id: forecast_condition_icon_3
                                  <<: *forcast_image_base
                                  src: unknown_80
                              - label:
                                  id: forecast_temperature_3
                                  <<: *forcast_label_base
                                  text: "--°"

packages:
  # header
  header_sensors: !include { file: widgets/header/sensors.yaml }
  # boot screen
  boot_screen_sensors: !include { file: widgets/boot_screen/sensors.yaml }
  # clock screen
  clock_screen_sensors: !include { file: pages/clock/sensors.yaml }
  # device status screen
  device_status_screen_sensors: !include { file: pages/status/sensors.yaml }
  # automatic screen control
  control_auto_display: !include { file: functions/control_auto_display.yaml }

  # Weather packages
  # Build icon set from .svg files
  weather_icons_80: !include
    file: weather/weather_icons.yaml
    vars:
      size: 80
  # Display weather forcast using icon set (defined above)
  weather_forcast_80: !include
    file: weather/weather_forecast.yaml
    vars:
      size: 80
  # Big icons for today weather
  weather_icons_200: !include
    file: weather/weather_icons.yaml
    vars:
      size: 200
  # Get todays weather and display it
  weather_today_200: !include
    file: weather/weather_today.yaml
    vars:
      size: 200